<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register - DailyCup</title>
  <link rel="stylesheet" href="../../css/style.css">
  <link rel="stylesheet" href="../../css/components.css">
  <link rel="stylesheet" href="../../css/responsive.css">
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="container">
      <div class="navbar-brand">
        <span>â˜•</span>
        <span>DailyCup</span>
      </div>
      <ul class="navbar-nav">
        <li><a href="../../index.html">Home</a></li>
        <li><a href="../customer/menu.html">Menu</a></li>
        <li><a href="login.html">Login</a></li>
        <li><a href="register.html" class="active">Register</a></li>
      </ul>
    </div>
  </nav>

  <!-- Register Form -->
  <section style="padding: 3rem 0; min-height: 70vh;">
    <div class="container">
      <div class="row">
        <div class="col-12 col-md-6" style="margin: 0 auto;">
          <div class="card">
            <div class="card-body">
              <h2 class="text-center mb-3">Create Account</h2>
              
              <form id="register-form">
                <div class="form-group">
                  <label class="form-label">Full Name</label>
                  <input type="text" class="form-control" id="name" required>
                </div>

                <div class="form-group">
                  <label class="form-label">Email</label>
                  <input type="email" class="form-control" id="email" required>
                </div>

                <div class="form-group">
                  <label class="form-label">Phone (Optional)</label>
                  <input type="tel" class="form-control" id="phone" placeholder="08xxxxxxxxxx">
                </div>

                <div class="form-group">
                  <label class="form-label">Password</label>
                  <input type="password" class="form-control" id="password" required>
                </div>

                <div class="form-group">
                  <label class="form-label">Confirm Password</label>
                  <input type="password" class="form-control" id="confirm-password" required>
                </div>

                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">
                  Register
                </button>
              </form>

              <div style="text-align: center; margin: 2rem 0;">
                <p style="color: var(--text-light);">Or register with</p>
                <div style="display: flex; gap: 1rem; justify-content: center;">
                  <a href="http://localhost:3000/api/auth/google" class="btn btn-outline">
                    Google
                  </a>
                  <a href="http://localhost:3000/api/auth/facebook" class="btn btn-outline">
                    Facebook
                  </a>
                </div>
              </div>

              <div class="text-center">
                <p>Already have an account? <a href="login.html">Login here</a></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-bottom">
        <p>&copy; 2024 DailyCup. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="../../js/api.js"></script>
  <script src="../../js/utils.js"></script>
  <script src="../../js/auth.js"></script>
  <script>
    document.getElementById('register-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirm-password').value;
      
      // Validate
      if (name.length < 3) {
        Utils.showAlert('Name must be at least 3 characters', 'error');
        return;
      }
      
      if (!Utils.isValidEmail(email)) {
        Utils.showAlert('Please enter a valid email address', 'error');
        return;
      }
      
      if (phone && !Utils.isValidPhone(phone)) {
        Utils.showAlert('Please enter a valid phone number', 'error');
        return;
      }
      
      if (password.length < 6) {
        Utils.showAlert('Password must be at least 6 characters', 'error');
        return;
      }
      
      if (password !== confirmPassword) {
        Utils.showAlert('Passwords do not match', 'error');
        return;
      }
      
      // Register
      await Auth.handleRegister({ name, email, phone, password });
    });

    // Redirect if already logged in
    if (Auth.isAuthenticated()) {
      const user = Auth.getCurrentUser();
      if (['admin', 'super_admin', 'staff'].includes(user.role)) {
        window.location.href = '../admin/dashboard.html';
      } else {
        window.location.href = '../customer/menu.html';
      }
    }
  </script>
</body>
</html>
